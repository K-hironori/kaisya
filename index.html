<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>未処理品番 処理進捗報告</title>
    <style>
        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', 'Meiryo', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        .page {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            page-break-after: always;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 28px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .summary {
            background-color: #e8f4f8;
            padding: 20px;
            border-left: 4px solid #3498db;
            margin: 20px 0;
            font-size: 16px;
        }

        .key-result {
            font-size: 18px;
            font-weight: bold;
            color: #e74c3c;
            text-align: center;
            margin: 15px 0;
        }

        .chart-container {
            margin: 30px 0;
            text-align: center;
        }

        .chart-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }

        th {
            background-color: #3498db;
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: bold;
        }

        td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:last-child {
            background-color: #fff3cd;
            font-weight: bold;
        }

        .analysis {
            margin: 30px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }

        .analysis h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .analysis ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .analysis li {
            margin-bottom: 8px;
        }

        .highlight {
            background-color: #fff3cd;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }

        .success {
            color: #27ae60;
            font-weight: bold;
        }

        .warning {
            color: #e74c3c;
            font-weight: bold;
        }

        .navigation {
            text-align: center;
            margin: 20px 0;
        }

        .nav-btn {
            padding: 10px 20px;
            margin: 0 10px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .nav-btn:hover {
            background-color: #2980b9;
        }

        .nav-btn:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }

        @media print {
            .navigation { display: none; }
            .page { box-shadow: none; margin-bottom: 0; }
        }
    </style>
</head>
<body>
    <!-- 1ページ目: 概要とグラフ -->
    <div class="page" id="page1">
        <h1>未処理品番 処理進捗報告書</h1>
        
        <div class="summary">
            <strong>【分析概要】</strong><br>
            初期未処理2,600品番から開始し、月次176品番の純減ペースで処理を継続した場合の進捗予測を分析しました。
            処理能力10品番/日（10品番で0.5H）、新規流入1.2品番/日、月次稼働20日の条件下での計算結果です。
        </div>

        <div class="key-result">
            🎯 <span class="warning">2026年10月</span>に未処理品番ゼロ到達予定
        </div>

        <div class="chart-container">
            <div class="chart-title">■ 未処理品番 月次推移</div>
            <canvas id="progressChart" width="800" height="300"></canvas>
        </div>

        <div class="analysis">
            <h3>📊 分析結果</h3>
            <ul>
                <li><strong>処理期間：</strong>約<span class="highlight">15ヶ月</span>（2025年8月〜2026年10月）</li>
                <li><strong>月次処理：</strong>200品番/月 - 24品番/月（新規）= <span class="success">176品番/月の純減</span></li>
                <li><strong>最終月：</strong>2026年10月の<span class="success">16日稼働</span>でゼロ到達</li>
                <li><strong>完了後：</strong>新規1.2品番/日の処理のみで安定運用可能</li>
            </ul>
        </div>

    </div>

    <!-- 2ページ目: 詳細データ表 -->
    <div class="page" id="page2" style="display:none;">
        <h1>月次処理データ詳細</h1>

        <table>
            <thead>
                <tr>
                    <th>処理月</th>
                    <th>期首残<br>(品番)</th>
                    <th>新規流入<br>(品番/月)</th>
                    <th>処理実行<br>(品番/月)</th>
                    <th>純減<br>(品番/月)</th>
                    <th>期末残<br>(品番)</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>2025-08</td><td>2,600</td><td>24.0</td><td>200</td><td>176.0</td><td>2,424</td></tr>
                <tr><td>2025-09</td><td>2,424</td><td>24.0</td><td>200</td><td>176.0</td><td>2,248</td></tr>
                <tr><td>2025-10</td><td>2,248</td><td>24.0</td><td>200</td><td>176.0</td><td>2,072</td></tr>
                <tr><td>2025-11</td><td>2,072</td><td>24.0</td><td>200</td><td>176.0</td><td>1,896</td></tr>
                <tr><td>2025-12</td><td>1,896</td><td>24.0</td><td>200</td><td>176.0</td><td>1,720</td></tr>
                <tr><td>2026-01</td><td>1,720</td><td>24.0</td><td>200</td><td>176.0</td><td>1,544</td></tr>
                <tr><td>2026-02</td><td>1,544</td><td>24.0</td><td>200</td><td>176.0</td><td>1,368</td></tr>
                <tr><td>2026-03</td><td>1,368</td><td>24.0</td><td>200</td><td>176.0</td><td>1,192</td></tr>
                <tr><td>2026-04</td><td>1,192</td><td>24.0</td><td>200</td><td>176.0</td><td>1,016</td></tr>
                <tr><td>2026-05</td><td>1,016</td><td>24.0</td><td>200</td><td>176.0</td><td>840</td></tr>
                <tr><td>2026-06</td><td>840</td><td>24.0</td><td>200</td><td>176.0</td><td>664</td></tr>
                <tr><td>2026-07</td><td>664</td><td>24.0</td><td>200</td><td>176.0</td><td>488</td></tr>
                <tr><td>2026-08</td><td>488</td><td>24.0</td><td>200</td><td>176.0</td><td>312</td></tr>
                <tr><td>2026-09</td><td>312</td><td>24.0</td><td>200</td><td>176.0</td><td>136</td></tr>
                <tr><td>2026-10</td><td>136</td><td>19.2</td><td>160</td><td>140.8</td><td>0</td></tr>
            </tbody>
        </table>

        <div class="analysis">
            <h3>📋 データ補足</h3>
            <ul>
                <li><strong>基本条件：</strong>処理能力10品番/日 × 稼働20日/月 = 200品番/月</li>
                <li><strong>新規流入：</strong>1.2品番/日 × 稼働20日/月 = 24品番/月</li>
                <li><strong>最終月：</strong>136品番÷8.8品番/日 = 15.5日 → 稼働16日で完了</li>
            </ul>
        </div>

        <div class="summary">
            <strong>【結論】</strong><br>
            現在の処理体制を維持した場合、<span class="warning">2026年10月16日稼働日</span>に未処理品番がゼロになる予定です。
            以降は新規流入分（1.2品番/日）の処理のみで運用が継続できます。
        </div>
    </div>

    <div class="navigation">
        <button class="nav-btn" id="prevBtn" onclick="changePage(-1)">← 前ページ</button>
        <span id="pageInfo">1 / 2</span>
        <button class="nav-btn" id="nextBtn" onclick="changePage(1)">次ページ →</button>
    </div>

    <script>
        let currentPage = 1;
        const totalPages = 2;

        function updatePage() {
            document.getElementById('page1').style.display = currentPage === 1 ? 'block' : 'none';
            document.getElementById('page2').style.display = currentPage === 2 ? 'block' : 'none';
            document.getElementById('pageInfo').textContent = `${currentPage} / ${totalPages}`;
            document.getElementById('prevBtn').disabled = currentPage === 1;
            document.getElementById('nextBtn').disabled = currentPage === totalPages;
            
            if (currentPage === 1) {
                setTimeout(drawChart, 100);
            }
        }

        function changePage(direction) {
            currentPage = Math.max(1, Math.min(totalPages, currentPage + direction));
            updatePage();
        }

        function drawChart() {
            const canvas = document.getElementById('progressChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const data = [2600, 2424, 2248, 2072, 1896, 1720, 1544, 1368, 1192, 1016, 840, 664, 488, 312, 136, 0];
            const months = ['2025-08', '2025-09', '2025-10', '2025-11', '2025-12', '2026-01', '2026-02', '2026-03', '2026-04', '2026-05', '2026-06', '2026-07', '2026-08', '2026-09', '2026-10'];
            
            const padding = 60;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 2;
            const maxValue = 2600;
            const stepX = chartWidth / (data.length - 1);
            
            // グリッド線
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }
            
            // Y軸目盛り
            ctx.fillStyle = '#666';
            ctx.font = '12px sans-serif';
            ctx.textAlign = 'right';
            
            for (let i = 0; i <= 5; i++) {
                const value = maxValue - (maxValue / 5) * i;
                const y = padding + (chartHeight / 5) * i + 4;
                ctx.fillText(value.toLocaleString(), padding - 10, y);
            }
            
            // X軸目盛り
            ctx.textAlign = 'center';
            for (let i = 0; i < months.length; i += 3) {
                const x = padding + stepX * i;
                const y = canvas.height - padding + 15;
                ctx.fillText(months[i], x, y);
            }
            
            // データライン
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            data.forEach((value, index) => {
                const x = padding + stepX * index;
                const y = padding + chartHeight - (value / maxValue) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            
            ctx.stroke();
            
            // データポイント
            ctx.fillStyle = '#2980b9';
            data.forEach((value, index) => {
                const x = padding + stepX * index;
                const y = padding + chartHeight - (value / maxValue) * chartHeight;
                
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, 2 * Math.PI);
                ctx.fill();
            });
        }

        // キーボードナビゲーション
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') changePage(-1);
            if (e.key === 'ArrowRight') changePage(1);
        });

        // 初期化
        updatePage();
    </script>
</body>
</html>